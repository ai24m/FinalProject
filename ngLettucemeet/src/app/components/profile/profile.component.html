<div class="container-fluid" *ngIf="adminLogin == false">
  <main class="tm-main">
    <div class="row tm-row">
      <div class="col-lg-8 tm-post-col">
        <div class="tm-post-full">
          <div class="mb-4">
            <!-- profile  -->
            <h2 class="pt-2 tm-color-primary tm-post-title">
              Welcome {{ user.username }}
              <img
                src="/assets/images/profile/profile.png"
                id="profile"
                alt="Image"
                class="mb-3 img-fluid"
              />
            </h2>
            <div *ngIf="!edit">
              <h4>Address</h4>
              {{ user.address?.street1 }}<br />
              {{ user.address?.street2 }}
              {{ user.address?.city }}<br />
              {{ user.address?.state }}<br />
              {{ user.address?.zip }}<br />
              <h4>Profile Info</h4>
              {{ user.firstName }}<br />
              {{ user.lastName }}<br />
              {{ user.businessname }}<br />
              {{ user.username }}<br />
              <p>
                Velvet Twilight Farms! Grow produce all year around, visit our
                Farm! insert map of location here
              </p>
            </div>
          </div>
          <!-- Post Comments -->
          <div>
            <h2 class="tm-color-primary tm-post-title">Reviews</h2>
            <hr class="tm-hr-primary tm-mb-45" />
            <div class="tm-comment tm-mb-45">
              <figure class="tm-comment-figure">
                <img
                  src="/assets/images/profile/apple.png"
                  alt="Image"
                  class="mb-2 rounded-circle img-thumbnail"
                />
                <figcaption class="tm-color-primary text-center">
                  Mark Sonny
                </figcaption>
              </figure>
              <div>
                <p>
                  Had really nice kale and mustard greens during the earlier
                  part of April at the Spring Valley Farmer's Market. Highly
                  reccommend!
                </p>
                <div class="d-flex justify-content-between">
                  <!-- <a href="#" class="tm-color-primary">REPLY</a> -->
                  <span class="tm-color-primary">June 14, 2020</span>
                </div>
              </div>
              <hr />
            </div>
            <div class="tm-comment tm-mb-45">
              <hr />
              <figure class="tm-comment-figure">
                <img
                  src="/assets/images/profile/tomato.png"
                  alt="Image"
                  class="mb-2 rounded-circle img-thumbnail"
                />
                <figcaption class="tm-color-primary text-center">
                  Hans Davidson
                </figcaption>
              </figure>
              <div>
                <p>
                  Great produce all year round, farm is family-friendly, highly
                  recommend.
                </p>
                <div class="d-flex justify-content-between">
                  <span class="tm-color-primary">June 27, 2020</span>
                </div>
              </div>
            </div>
            <div class="tm-comment tm-mb-45">
              <div class="tm-comment">
                <figure class="tm-comment-figure">
                  <img
                    src="/assets/images/profile/mushroom.png"
                    alt="Image"
                    class="mb-2 rounded-circle img-thumbnail"
                  />
                  <figcaption class="tm-color-primary text-center">
                    Jewel Lowe
                  </figcaption>
                </figure>
                <div>
                  <p>
                    All the produce were cleaned well, sad that Velvet Twilight
                    doesn't appear to the Sparkleberry Market anymore but
                    definitely stop by their farm in Sumter!
                  </p>
                  <div class="d-flex justify-content-between">
                    <span class="tm-color-primary">June 14, 2020</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <aside class="col-lg-4 tm-aside-col">
        <div class="tm-post-sidebar">
          <hr class="mb-3 tm-hr-primary" />
          <h2 class="mb-4 tm-post-title tm-color-primary">Product Listings</h2>
          <a class="d-block tm-mb-40" *ngFor="let p of products">
            <figure>
              <h5>
                <a [routerLink]="['/home/']"> {{ p.name }}</a>
              </h5>
              <!-- <img src="img/img-05.jpg" alt="Image" class="mb-3 img-fluid"> -->
              <figcaption class="tm-color-primary">
                {{ organic(p.organic) }},
              </figcaption>
              <figcaption class="tm-color-primary">
                Available Date: {{ p.availableDate }}
              </figcaption>
              <figcaption class="tm-color-primary" *ngIf="p.markets != null">
                <figcaption
                  class="tm-color-primary"
                  *ngFor="let m of p.markets"
                >
                  Vendor At: {{ m.name }}, {{ m.address.city }}
                </figcaption>
              </figcaption>
              <figcaption class="tm-color-primary" *ngIf="p.markets == null">
                <div class="text-right">
                  <button
                    (click)="addProductToMarket = !addProductToMarket"
                    value="Add To Market"
                    class="tm-btn tm-btn-primary tm-btn-small"
                  >
                    Submit
                  </button>
                </div>
                <figcaption class="tm-color-primary">
                  <input type="button" />
                </figcaption>
              </figcaption>
            </figure>
          </a>
          <!-- Add New Product -->
          <hr class="mb-3 tm-hr-primary" />
          <figure>
            <form action="" class="mb-5 tm-comment-form">
              <h2 class="tm-color-primary tm-post-title mb-4">
                Add New Listing
              </h2>
              <div class="mb-4">
                <input
                  class="form-control"
                  [(ngModel)]="newProduct.name"
                  name="name"
                  placeholder="name"
                  type="text"
                />
              </div>
              <div class="mb-4">
                <textarea
                  class="form-control"
                  [(ngModel)]="newProduct.description"
                  name="description"
                  placeholder="description"
                  rows="6"
                ></textarea>
              </div>
              <div class="mb-4">
                <!-- <app-file-upload formControlName="image" [progress]="progress"></app-file-upload> -->
                <textarea
                  class="form-control"
                  [(ngModel)]="newProduct.imageUrl"
                  name="imageUrl"
                  placeholder="imageUrl"
                  rows="6"
                ></textarea>
              </div>
              <div class="mb-4">
                <!-- <app-file-upload formControlName="image" [progress]="progress"></app-file-upload> -->
                <input
                  type="Date"
                  class="form-control"
                  [(ngModel)]="newProduct.availableDate"
                  name="availableDate"
                />
              </div>
              <div class="mb-4">
                <label for="types">Please Select One</label>
                <select id="type" [(ngModel)]="newProduct.organic">
                  <option>---Select---</option>
                  <option value="true">Organic</option>
                  <option value="false">Non-Organic</option>
                </select>
              </div>
              <div class="mb-4">
                <label for="types">Type of Product</label>
                <select name="type" [(ngModel)]="newProduct.type.id">
                  <option *ngFor="let t of types" value="{{ t.id }}">
                    {{ t.name }}
                  </option>
                </select>
              </div>
              <div class="text-right">
                <button
                  (click)="addProduct(newProduct)"
                  value="Add Product"
                  class="tm-btn tm-btn-primary tm-btn-small"
                >
                  Submit
                </button>
              </div>
            </form>
          </figure>
        </div>
        <!-- Add Product To Market -->

        <figure *ngIf="!addProductToMarket">
          <form action="" class="mb-5 tm-comment-form">
            <h2 class="tm-color-primary tm-post-title mb-4">Add New Listing</h2>
            <div class="mb-4">
              <input
                class="form-control"
                [(ngModel)]="newProduct.name"
                name="name"
                placeholder="name"
                type="text"
              />
            </div>
            <div class="mb-4">
              <textarea
                class="form-control"
                [(ngModel)]="newProduct.description"
                name="description"
                placeholder="description"
                rows="6"
              ></textarea>
            </div>
            <div class="mb-4">
              <!-- <app-file-upload formControlName="image" [progress]="progress"></app-file-upload> -->
              <textarea
                class="form-control"
                [(ngModel)]="newProduct.imageUrl"
                name="imageUrl"
                placeholder="imageUrl"
                rows="6"
              ></textarea>
            </div>
            <div class="mb-4">
              <!-- <app-file-upload formControlName="image" [progress]="progress"></app-file-upload> -->
              <input
                type="Date"
                class="form-control"
                [(ngModel)]="newProduct.availableDate"
                name="availableDate"
              />
            </div>
            <div class="mb-4">
              <label for="types">Please Select One</label>
              <select id="type" [(ngModel)]="newProduct.organic">
                <option>---Select---</option>
                <option value="true">Organic</option>
                <option value="false">Non-Organic</option>
              </select>
            </div>
            <div class="mb-4">
              <label for="types">Type of Product</label>
              <select name="type" [(ngModel)]="newProduct.type.id">
                <option *ngFor="let t of types" value="{{ t.id }}">
                  {{ t.name }}
                </option>
              </select>
            </div>
            <div class="text-right">
              <button
                (click)="addProduct(newProduct)"
                value="Add Product"
                class="tm-btn tm-btn-primary tm-btn-small"
              >
                Submit
              </button>
            </div>
          </form>
        </figure>
      </aside>
    </div>
    <footer class="row tm-row">
      <hr />
    </footer>
  </main>
</div>


<!-- start of admin page -->
<div *ngIf="adminLogin == true" style="margin-left: 50%">
  <div>
    <button
      name="showUsers"
      class="tm-btn tm-btn-primary tm-btn-small"
      (click)="getUsers()"
    >
      Users
    </button>
    <div>
      <table class="table table-success table-striped">
        <thead>
          <tr>
            <th>Username:</th>
            <th>Email:</th>
            <th>Role:</th>
            <th>Disable:</th>
          </tr>
        </thead>
        <tbody>
          <tr
            [ngClass]="user.disabled == true ? 'disabled' : ''"
            *ngFor="let user of users"
          >
            <td>{{ user.username }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.role }}</td>
            <td>
              <button
                name="deleteUser"
                class="btn btn-danger btn-hover"
                (click)="deleteUser(user)"
              >
                X
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div>
    <button
      name="showProducts"
      class="tm-btn tm-btn-primary tm-btn-small"
      (click)="getProducts()"
    >
      Products
    </button>
    <div>
      <table class="table table-success table-striped">
        <thead>
          <tr>
            <th>Owning User:</th>
            <th>Name:</th>
            <th>Type:</th>
            <th>Disable:</th>
          </tr>
        </thead>
        <tbody>
          <tr
            [ngClass]="product.disabled == true ? 'disabled' : ''"
            *ngFor="let product of products"
          >
            <td>{{ product.user.username }}</td>
            <td>{{ product.name }}</td>
            <td>{{ product.type.name }}</td>
            <td>
              <button
                name="deleteProduct"
                class="btn btn-danger btn-hover"
                (click)="deleteProduct(product)"
              >
                X
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div>
    <button
      name="showMarkets"
      class="tm-btn tm-btn-primary tm-btn-small"
      (click)="getMarkets()"
    >
      Markets
    </button>
    <div>
      <table class="table table-success table-striped">
        <thead>
          <tr>
            <th>Owning User:</th>
            <th>Name:</th>
            <th>Disable:</th>
          </tr>
        </thead>
        <tbody>
          <tr
            [ngClass]="market.disabled == true ? 'disabled' : ''"
            *ngFor="let market of markets"
          >
            <td>{{ market.user.username }}</td>
            <td>{{ market.name }}</td>
            <td>
              <button
                name="deleteMarket"
                class="btn btn-danger btn-hover"
                (click)="deleteMarket(market)"
                [(ngModel)]="!market.disabled"
              >
                X
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
